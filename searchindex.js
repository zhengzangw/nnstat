Search.setIndex({"docnames": ["api/accum", "api/functional", "api/nnstat", "api/optim", "api/utils", "index", "tutorials/getting_started", "tutorials/installation"], "filenames": ["api/accum.rst", "api/functional.rst", "api/nnstat.rst", "api/optim.rst", "api/utils.rst", "index.rst", "tutorials/getting_started.rst", "tutorials/installation.rst"], "titles": ["nnstat.accum", "nnstat.functional", "nnstat", "nnstat.optim", "nnstat.utils", "NNstat documentation", "Getting Started", "Installation"], "terms": {"see": [2, 5, 6], "get": [2, 4, 5], "start": [2, 5], "basic": [2, 6], "usag": 2, "core": 2, "from_state_dict": [2, 6], "raw_state_dict": 2, "pattern": [1, 2, 6], "none": [1, 2, 4, 6], "clone": [2, 6, 7], "fals": [2, 4, 6], "devic": [2, 6], "dtype": [2, 6], "name": [2, 4, 6], "sourc": [1, 2, 4, 7], "creat": 2, "statedict": [1, 2, 6], "from": [2, 6], "raw": 2, "state": [2, 6], "dict": [2, 4, 6], "model": [2, 6], "state_dict": [2, 6], "paramet": [1, 2, 4, 6], "str": [1, 2, 4], "torch": [2, 4, 6], "tensor": [2, 4, 6], "union": [1, 2, 4], "option": [1, 2, 4], "regex": 2, "filter": [1, 2, 6], "kei": [2, 6], "onli": 2, "match": 2, "kept": 2, "default": [1, 2, 4], "which": 2, "mean": [2, 6], "bool": [1, 2, 4], "return": [1, 2, 4], "share": 2, "same": 2, "memori": 2, "one": [2, 6], "except": 2, "being": 2, "detach": 2, "us": [1, 2, 6], "true": [1, 2, 6], "make": 2, "snapshot": 2, "cpu": [2, 6], "save": [2, 4], "gpu": 2, "when": 2, "copi": 2, "you": [2, 5], "cannot": 2, "set": [2, 4], "move": 2, "thi": [2, 6], "togeth": 2, "cast": 2, "from_weight": [2, 6], "requires_grad": 2, "contain": 2, "weight": [1, 2, 6], "pytorch": 2, "nn": 2, "modul": [2, 6], "keep": [2, 6], "from_grad": [2, 6], "gradient": [2, 6], "loss": [2, 6], "backward": [2, 6], "from_optimizer_st": [2, 6], "optim": [2, 5, 6], "optimizer_kei": 2, "an": [2, 6], "exp_avg": [2, 6], "For": [2, 6], "adam": [2, 6], "can": [2, 5, 6], "from_togeth": [2, 6], "exp_avg_sq": [2, 6], "list": [2, 4, 5], "tupl": 2, "from_activ": [2, 6], "regist": 2, "forward": [2, 6], "hook": 2, "The": [2, 5, 6], "activ": [2, 5, 6], "store": 2, "attribut": 2, "object": [2, 6], "after": [2, 6], "pass": 2, "updat": [1, 2, 5], "i": [1, 2, 4, 5, 6], "empti": 2, "x": [2, 4], "print": [2, 6], "forwardhook": 2, "class": 2, "wrap": 2, "ha": [2, 6], "from_activation_grad": 2, "backwardhook": 2, "arg": 2, "kwarg": [2, 4], "main": 2, "ar": [2, 6], "suppos": 2, "valu": [2, 4, 6], "other": [2, 6], "It": 2, "provid": 2, "mani": 2, "function": [2, 4, 5, 6], "analyz": [2, 5, 6], "support": [2, 5], "math": 2, "oper": 2, "method": [2, 6], "divid": 2, "three": 2, "categori": 2, "reduct": 2, "visual": [2, 5], "shape": [2, 6], "input": 2, "more": [2, 5, 6], "detail": [2, 6], "found": [2, 5], "appli": 2, "exampl": [2, 6], "includ": [2, 6], "ab": 2, "clip": 2, "sign": 2, "etc": [2, 5], "scalar": 2, "apply_reduct": 2, "norm": [1, 2, 6], "var": 2, "all": [2, 6], "lw": [1, 2, 6], "argument": [2, 6], "layer": [1, 2, 6], "wise": [1, 2], "otherwis": 2, "whole": 2, "give": 2, "summari": 2, "describ": [2, 6], "hist": 2, "ecdf": [2, 4], "heatmap": [2, 4], "variabl": 2, "_name": 2, "displai": 2, "_is_tensor": 2, "whether": [1, 2], "_light_dict": 2, "light": 2, "string": 2, "A": [2, 5], "typic": 2, "result": 2, "have": [2, 5], "differ": [2, 6], "style": 2, "If": [2, 5], "current": [2, 5, 6], "_flatten": 2, "holder": 2, "flatten": 2, "lazi": 2, "evalu": 2, "__init__": 2, "subclass": 2, "ordereddict": 2, "avoid": 2, "call": 2, "directli": [2, 6], "instead": 2, "factori": 2, "inplac": 2, "self": 2, "set_nam": 2, "index": 2, "given": 2, "int": [1, 2], "ani": [2, 5], "type": [2, 4], "load": 2, "path": [2, 4], "file": [2, 4], "is_compat": 2, "check": [2, 6], "two": 2, "compat": 2, "anoth": [2, 6], "implement": 2, "By": 2, "cach": [2, 4], "want": [2, 5, 6], "should": 2, "convert": [2, 4], "func": 2, "construct": 2, "element": [2, 6], "each": [2, 6], "new": 2, "we": [2, 5, 6], "follow": [2, 5, 6], "code": [2, 7], "comput": [2, 5], "m": [2, 6], "v": [2, 6], "sqrt": [2, 6], "1e": [2, 6], "8": [2, 6], "callabl": 2, "apply_": 2, "version": 2, "squar": 2, "root": 2, "sqrt_": 2, "absolut": 2, "abs_": 2, "zero": [2, 6], "zeros_": 2, "ones": 2, "ones_": 2, "sign_": 2, "min": [2, 4], "max": [2, 4], "float": [2, 4, 6], "clip_": 2, "resnet": 2, "p": [1, 2], "2": [1, 2, 5, 6], "98": 2, "5264": 2, "resnet_weights_stat": 2, "01": [2, 6], "bn1": [2, 6], "280656576156616": 2, "02": [2, 6], "bia": [2, 6], "7802467346191406": 2, "03": [2, 6], "layer1": [2, 6], "0": [2, 6], "conv1": [2, 6], "10": [2, 6], "269349098205566": 2, "04": [2, 6], "8918473720550537": 2, "05": [2, 6], "1": [2, 6], "6855857372283936": 2, "truncat": [2, 6], "conv": [2, 6], "00": [2, 6], "12": 2, "579392433166504": 2, "conv2": [2, 6], "680017471313477": 2, "9": [2, 6], "771225929260254": 2, "446762084960938": 2, "layer2": 2, "11": [2, 6], "297880172729492": 2, "per": 2, "register_reduct": 2, "columns_group": 2, "your": 2, "own": 2, "maximum": 2, "minimum": 2, "number": 2, "id": 2, "numel": [2, 6], "lp": 2, "norm1": [2, 6], "l1": 2, "norm2": [2, 6], "l2": [2, 6], "sum": 2, "norm1_mean": [2, 6], "varianc": 2, "std": [2, 6], "standard": [2, 6], "deviat": [2, 6], "skew": 2, "kurtosi": 2, "abs_max": 2, "abs_min": 2, "group": 2, "include_kei": [2, 6], "exlude_kei": 2, "additional_info": 2, "collect": 2, "statist": [2, 5, 6], "There": [2, 6], "wai": [2, 6], "first": [2, 6], "breakpoint": 2, "stat": [2, 6], "resnet_weight": [2, 6], "11689512": [2, 6], "235774": 2, "53125": 2, "02017": 2, "113": [2, 6], "108963": 2, "64": [2, 6], "3": [2, 6], "7": [2, 6], "9408": [2, 6], "188": [2, 6], "525146": 2, "438898": 2, "36864": [2, 6], "1736": 2, "147461": 2, "318304": 2, "389282": 2, "336217": 2, "1733": 2, "171997": 2, "316651": 2, "4": [2, 6], "1724": 2, "930786": 2, "236347": 2, "second": [2, 6], "In": 2, "case": 2, "log": [2, 4], "3rd": 2, "parti": 2, "tool": 2, "tensorboard": [2, 5], "wandb": [2, 5], "state_log": 2, "235752": 2, "828125": 2, "10881805419922": 2, "iter": [2, 6], "iter_num": 2, "step": [2, 6], "defin": [1, 2, 6], "select": 2, "_light": 2, "custom": [2, 6], "e": [2, 7], "ignor": [2, 6], "ad": 2, "must": 2, "exclud": 2, "addit": 2, "inform": [2, 5, 6], "bin": [2, 4], "100": 2, "logx": [2, 4], "logi": [2, 4], "plot": [2, 4], "histogram": [2, 4], "directori": [2, 4], "cache_nnstat": [2, 4], "chang": [2, 5, 6], "set_cache_dir": [2, 4], "whose": 2, "cahc": 2, "util": [2, 5], "my_cache_dir": 2, "multipl": 2, "scale": [2, 4], "axi": 2, "y": [2, 4], "empir": 2, "cumul": 2, "distribut": 2, "vmin": [2, 4], "vmax": [2, 4], "help": 4, "item": 4, "t": 4, "get_cache_dir": 4, "plot_lin": 4, "df": 4, "tmp": 4, "plot_hist": 4, "auto": 4, "data": 4, "plot_ecdf": 4, "plot_heatmap": 4, "toolkit": 5, "track": [5, 6], "statu": [5, 6], "neural": [5, 6], "network": [1, 5, 6], "easili": 5, "record": 5, "still": 5, "under": 5, "develop": 5, "mai": 5, "futur": 5, "readm": 5, "question": 5, "suggest": 5, "contribut": 5, "pleas": 5, "feel": 5, "free": 5, "contact": 5, "u": 5, "test": 5, "framework": 5, "continu": 5, "gpt": [5, 6], "nanogpt": [5, 6], "sophia": [5, 6], "previou": [5, 6], "awesom": 5, "instal": 5, "trust": [1, 5], "ratio": [1, 5], "accum": 5, "nnstat": [6, 7], "librari": 6, "like": 6, "also": 6, "With": 6, "easi": 6, "resnet18": 6, "import": 6, "torchvis": 6, "recommend": 6, "53": [], "689": 6, "512": 6, "download": 7, "pip": 7, "git": 7, "http": 7, "github": 7, "com": 7, "zhengzangw": 7, "cd": 7, "To": 6, "via": 6, "62": 6, "193847": [], "40625": [], "016583": [], "526398": [], "layerwis": 6, "716": [], "454041": [], "076154": [], "579392": [], "1166": [], "005371": [], "031630": [], "269349": [], "6": 6, "1179": [], "835815": [], "032005": [], "680017": [], "1263": [], "204834": [], "034267": [], "771226": [], "pre": 2, "param": 5, "randomli": 6, "initi": 6, "235797": 6, "859375": 6, "020172": 6, "1194": 6, "483765": 6, "020034": 6, "434446": 6, "1720": 6, "965454": 6, "046684": 6, "248564": 6, "1737": 6, "153442": 6, "047123": 6, "347944": 6, "1725": 6, "072632": 6, "046796": 6, "237497": 6, "regular": 6, "express": 6, "000200": 6, "025099": 6, "000027": 6, "058587": 6, "000487": 6, "059103": 6, "let": 6, "": 6, "do": 6, "quick": 6, "close": 6, "kaim": 6, "fanout": 6, "time": 6, "3136": 6, "0253": 6, "approx": 6, "0251": 6, "sigma": 6, "Then": 6, "n": 6, "436": 6, "434": 6, "o": 6, "w": 6, "_2": 6, "determin": 6, "now": 6, "turn": 6, "train": [1, 6], "small": 6, "checkpoint": 6, "50000": 6, "calcul": 6, "between": [1, 6], "weight_0": 6, "loop": 6, "here": [1, 6], "note": 6, "without": 6, "thu": 6, "equival": 6, "becaus": 6, "clear": 6, "sinc": 6, "adamw": 6, "recomput": 6, "zero_grad": 6, "grad": 6, "update_adam": 6, "lr": 6, "repo": 6, "epsilon": 6, "correct": 6, "decai": 6, "examin": 6, "embed": 6, "distributeddataparallel_weight": 6, "639": 6, "124": 6, "373": 6, "760": 6, "cuda": 6, "transform": 6, "wte": 6, "50304": 6, "768": 6, "wpe": 6, "1024": 6, "h": 6, "ln_1": 6, "allclos": 6, "atol": 6, "fp32": 6, "accept": 6, "23": 6, "bit": 6, "mantissa": 6, "precis": 6, "about": 6, "23approx": [], "trust_ratio": [1, 6], "reciproc": [1, 6], "larg": [1, 6], "batch": [1, 6], "convolut": [1, 6], "rust": 1, "order": 1, "measur": 6, "metric": 6, "among": 6, "balanc": 6, "origin": 6, "paper": 6, "definit": 6, "intuit": 6, "line": 6, "trust_ratio_mlp": 6, "mlp": 6, "c_fc": 6, "001064": 6, "c_proj": 6, "001172": 6, "001089": 6, "000974": 6, "001014": 6, "5": 6, "001087": 6, "001020": 6, "001065": 6, "001040": 6, "001049": 6, "001067": 6, "001017": 6, "As": 6}, "objects": {"nnstat": [[0, 0, 0, "-", "accum"], [2, 0, 0, "-", "core"], [1, 0, 0, "-", "functional"], [3, 0, 0, "-", "optim"], [4, 0, 0, "-", "utils"]], "nnstat.core": [[2, 1, 1, "", "StateDict"], [2, 3, 1, "", "from_activation"], [2, 3, 1, "", "from_activation_grad"], [2, 3, 1, "", "from_grad"], [2, 3, 1, "", "from_optimizer_state"], [2, 3, 1, "", "from_state_dict"], [2, 3, 1, "", "from_together"], [2, 3, 1, "", "from_weight"], [2, 3, 1, "", "load"]], "nnstat.core.StateDict": [[2, 2, 1, "", "__init__"], [2, 2, 1, "", "abs"], [2, 2, 1, "", "abs_"], [2, 2, 1, "", "abs_max"], [2, 2, 1, "", "abs_min"], [2, 2, 1, "", "apply"], [2, 2, 1, "", "apply_"], [2, 2, 1, "", "apply_reduction"], [2, 2, 1, "", "at"], [2, 2, 1, "", "clip"], [2, 2, 1, "", "clip_"], [2, 2, 1, "", "clone"], [2, 2, 1, "", "describe"], [2, 2, 1, "", "ecdf"], [2, 2, 1, "", "filter"], [2, 2, 1, "", "flatten"], [2, 2, 1, "", "heatmap"], [2, 2, 1, "", "hist"], [2, 2, 1, "", "is_compatible"], [2, 2, 1, "", "kurtosis"], [2, 2, 1, "", "max"], [2, 2, 1, "", "mean"], [2, 2, 1, "", "min"], [2, 2, 1, "", "name"], [2, 2, 1, "", "no"], [2, 2, 1, "", "norm"], [2, 2, 1, "", "norm1"], [2, 2, 1, "", "norm1_mean"], [2, 2, 1, "", "norm2"], [2, 2, 1, "", "numel"], [2, 2, 1, "", "ones"], [2, 2, 1, "", "ones_"], [2, 2, 1, "", "register_reduction"], [2, 2, 1, "", "save"], [2, 2, 1, "", "set_name"], [2, 2, 1, "", "shape"], [2, 2, 1, "", "sign"], [2, 2, 1, "", "sign_"], [2, 2, 1, "", "skew"], [2, 2, 1, "", "sqrt"], [2, 2, 1, "", "sqrt_"], [2, 2, 1, "", "state_dict"], [2, 2, 1, "", "std"], [2, 2, 1, "", "sum"], [2, 2, 1, "", "to"], [2, 2, 1, "", "value"], [2, 2, 1, "", "var"], [2, 2, 1, "", "zeros"], [2, 2, 1, "", "zeros_"]], "nnstat.functional": [[1, 3, 1, "", "trust_ratio"]], "nnstat.utils": [[4, 3, 1, "", "get_cache_dir"], [4, 3, 1, "", "itemize"], [4, 3, 1, "", "plot_ecdf"], [4, 3, 1, "", "plot_heatmap"], [4, 3, 1, "", "plot_hist"], [4, 3, 1, "", "plot_line"], [4, 3, 1, "", "set_cache_dir"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"nnstat": [0, 1, 2, 3, 4, 5], "accum": 0, "function": 1, "optim": 3, "util": 4, "document": 5, "tutori": 5, "python": 5, "api": 5, "get": 6, "start": 6, "statedict": [], "updat": 6, "comput": 6, "trust": 6, "ratio": 6, "instal": 7, "param": 6, "gradient": []}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 60}, "alltitles": {"nnstat.accum": [[0, "module-nnstat.accum"]], "nnstat.optim": [[3, "module-nnstat.optim"]], "nnstat.utils": [[4, "module-nnstat.utils"]], "NNstat documentation": [[5, "nnstat-documentation"]], "Tutorials": [[5, null]], "Python API": [[5, null]], "Installation": [[7, "installation"]], "nnstat": [[2, "module-nnstat.core"]], "nnstat.functional": [[1, "module-nnstat.functional"]], "Getting Started": [[6, "getting-started"]], "Get the Params": [[6, "get-the-params"]], "Get the Update": [[6, "get-the-update"]], "Compute the Trust Ratio": [[6, "compute-the-trust-ratio"]]}, "indexentries": {}})